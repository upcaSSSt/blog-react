import{w as l}from"./with-props-BITBR5i4.js";import{v as f,a as e,o as t,L as h}from"./chunk-D4RADZKF-F8gbsHt2.js";import{C as x}from"./global-DqGd4opN.js";import{P as j,A as w}from"./post-tiVzxYm2.js";import"./ava-C2JHgPho.js";function $({}){return[]}const E=l(function(){var c;const{id:o}=f(),{curUser:r}=e.useContext(x),n=e.useRef(""),[a,i]=e.useState({});e.useEffect(()=>{(async()=>{const m=await(await fetch(`http://localhost:3000/api/v1/posts/${o}`)).json();i(m)})()},[]);async function u(s){s.preventDefault();const d=await(await fetch(`http://localhost:3000/api/v1/users/${r.id}/posts/${o}/comments`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({comment:n.current.value})})).json(),p=window.structuredClone(a);p.comments.unshift({...d,name:r.name}),i(p),n.current.value=""}return t.jsxs("section",{className:"section",children:[t.jsx(j,{post:a}),t.jsxs("form",{action:"",onSubmit:u,children:[t.jsx("textarea",{className:"input",placeholder:"Комментарий...",ref:n}),t.jsxs("div",{className:"row",children:[t.jsx("button",{className:"btn",children:"Отправить"}),t.jsx(h,{to:`/edit/${o}`,className:"btn",children:"Редактировать пост"})]})]}),(c=a.comments)==null?void 0:c.map(s=>t.jsxs("div",{className:"post",children:[t.jsx(w,{id:s.user_id,name:s.name,time:s.time}),t.jsx("p",{children:s.body})]},s.id))]})});export{E as default,$ as meta};
