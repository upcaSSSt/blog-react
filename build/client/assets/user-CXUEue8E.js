import{w as p}from"./with-props-BITBR5i4.js";import{v as w,t as h,a,o as s,L as x}from"./chunk-D4RADZKF-F8gbsHt2.js";import{C}from"./context-DqGd4opN.js";import{C as j}from"./card-CeJAm_5I.js";import{P as b}from"./post-tiVzxYm2.js";import"./ava-C2JHgPho.js";const E=p(function(){var c;const{id:t}=w(),m=h(),{curUser:o,setCurUser:u}=a.useContext(C),[n,d]=a.useState({});a.useEffect(()=>{(async()=>{const i=await(await fetch(`http://localhost:3000/api/v1/users/${t}`)).json();d(i)})()},[]);async function r(e){const f=await(await fetch(`http://localhost:3000/users/${o.id}/follow/${t}/${e}.json`,{method:"post"})).json(),l=window.structuredClone(o);l.following_ids=f,u(l),m("/")}return s.jsxs("section",{className:"section",children:[s.jsx(j,{id:t,name:n.name}),o.name&&(o.id==t&&s.jsx(x,{className:"btn",to:"/new",children:"Пост"})||o.following_ids.includes(+t)&&s.jsx("button",{className:"btn btn_red",onClick:()=>r(!1),children:"Отписаться"})||s.jsx("button",{className:"btn",onClick:()=>r(!0),children:"Подписаться"})),(c=n.posts)==null?void 0:c.map(e=>s.jsx(b,{post:e},e.id))]})});export{E as default};
